"use strict";(self["webpackChunkproject_vue3_finally"]=self["webpackChunkproject_vue3_finally"]||[]).push([[108],{108:function(t,e,s){s.r(e),s.d(e,{default:function(){return W}});var r=s(3396),i=s(7139);const a=(0,r._)("section",{class:"mt-7"},[(0,r._)("div",{class:"container"},[(0,r._)("div",{class:"row justify-content-center align-items-center position-relative mt-5"},[(0,r._)("div",{class:"col-10"},[(0,r._)("div",{class:"progress mx-3",style:{height:"5px"}},[(0,r._)("div",{class:"progress-bar bg-brown",role:"progressbar",style:{width:"100%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})])]),(0,r._)("div",{class:"col-10 d-flex justify-content-between position-absolute top-0 translate-middle-y mt-3"},[(0,r._)("div",{class:"text-center"},[(0,r._)("span",{class:"badge bg-brown text-beige rounded-circle p-2",style:{width:"2rem",height:"2rem"}},[(0,r._)("i",{class:"bi bi-bag-check-fill"})]),(0,r._)("p",{class:"mb-0"},"購物車")]),(0,r._)("div",{class:"text-center"},[(0,r._)("span",{class:"badge bg-brown text-beige rounded-circle p-2",style:{width:"2rem",height:"2rem"}},[(0,r._)("i",{class:"bi bi-clipboard-check-fill"})]),(0,r._)("p",{class:"mb-0"},"填寫資料")]),(0,r._)("div",{class:"text-center"},[(0,r._)("span",{class:"badge bg-brown text-beige rounded-circle p-2",style:{width:"2rem",height:"2rem"}},[(0,r._)("i",{class:"bi bi-credit-card-fill"})]),(0,r._)("p",{class:"mb-0"},"付款確認")])])])])],-1),l={class:"my-6"},c={class:"container"},n={class:"border p-3 p-md-5"},o={class:"row justify-content-center"},d={class:"col-12 col-lg-8 py-3 text-brown table-responsive"},h=(0,r._)("h2",{class:"fs-3"},[(0,r._)("i",{class:"bi bi-flower3"}),(0,r.Uk)("購物清單")],-1),u={class:"table align-middle mt-3"},b=(0,r._)("thead",{class:"table-beige text-brown text-nowrap"},[(0,r._)("tr",null,[(0,r._)("th",null,"品名"),(0,r._)("th",{class:"text-end"},"單價"),(0,r._)("th",{class:"text-end"},"數量"),(0,r._)("th",{class:"text-end"},"小計")])],-1),_={class:"text-brown text-nowrap"},p={class:"text-end"},g={class:"text-end"},m={class:"text-end"},w={class:"w-100"},x=(0,r._)("td",{class:"text-end py-2"},"運費",-1),y={class:"text-end w-50"},v={class:"text-success"},f=(0,r._)("td",{class:"text-end py-2"},"優惠折扣",-1),L={class:"text-end w-50"},k={class:"border-top border-brown"},z=(0,r._)("td",{class:"text-end py-2"},"總計金額",-1),$={class:"text-end w-50"},C={class:"col-12 col-lg-8 mt-3 table-responsive"},I=(0,r._)("h2",{class:"fs-3 text-brown"},[(0,r._)("i",{class:"bi bi-flower3"}),(0,r.Uk)("收件人資料")],-1),O={class:"table border mt-3"},D={class:"text-brown text-nowrap"},j=(0,r._)("th",{width:"100",class:"table-beige text-brown"},"Email",-1),T=(0,r._)("th",{class:"table-beige text-brown"},"姓名",-1),q=(0,r._)("th",{class:"table-beige text-brown"},"收件人電話",-1),H=(0,r._)("th",{class:"table-beige text-brown"},"收件人地址",-1),N=(0,r._)("th",{class:"table-beige text-brown"},"付款狀態",-1),F={key:0,class:"text-secondary"},U={key:1,class:"text-success"},Y={key:0,class:"text-end"};function B(t,e,s,B,E,K){const R=(0,r.up)("LoadingView");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(R,{active:E.isLoading},null,8,["active"]),a,(0,r._)("section",l,[(0,r._)("div",c,[(0,r._)("div",n,[(0,r._)("div",o,[(0,r._)("form",d,[h,(0,r._)("table",u,[b,(0,r._)("tbody",_,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(E.order.products,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.id},[(0,r._)("td",null,(0,i.zw)(e.product.title),1),(0,r._)("td",p,(0,i.zw)(t.$filters.currency(e.product.price)),1),(0,r._)("td",g,(0,i.zw)(e.qty)+" / "+(0,i.zw)(e.product.unit),1),(0,r._)("td",m,(0,i.zw)(t.$filters.currency(e.total)),1)])))),128))])]),(0,r._)("table",w,[(0,r._)("tbody",null,[(0,r._)("tr",null,[x,(0,r._)("td",y,"NT$ "+(0,i.zw)(t.$filters.currency(E.deliveryFee)),1)]),(0,r._)("tr",v,[f,(0,r._)("td",L,"- NT$ "+(0,i.zw)(t.$filters.currency(E.cart.total-E.cart.final_total)),1)]),(0,r._)("tr",k,[z,(0,r._)("td",$,"NT$ "+(0,i.zw)(t.$filters.currency(E.order.total)),1)])])])]),(0,r._)("form",C,[I,(0,r._)("table",O,[(0,r._)("tbody",D,[(0,r._)("tr",null,[j,(0,r._)("td",null,(0,i.zw)(E.order.user.email),1)]),(0,r._)("tr",null,[T,(0,r._)("td",null,(0,i.zw)(E.order.user.name),1)]),(0,r._)("tr",null,[q,(0,r._)("td",null,(0,i.zw)(E.order.user.tel),1)]),(0,r._)("tr",null,[H,(0,r._)("td",null,(0,i.zw)(E.order.user.address),1)]),(0,r._)("tr",null,[N,(0,r._)("td",null,[E.order.is_paid?((0,r.wg)(),(0,r.iD)("span",U,"付款完成")):((0,r.wg)(),(0,r.iD)("span",F,"尚未付款"))])])])]),!1===E.order.is_paid?((0,r.wg)(),(0,r.iD)("div",Y,[(0,r._)("button",{type:"button",onClick:e[0]||(e[0]=(...t)=>K.payOrder&&K.payOrder(...t)),class:"btn btn-brown"},"確認付款")])):(0,r.kq)("",!0)])])])])])],64)}s(7658);var E=s(5147),K=s.n(E),R={data(){return{cart:{},order:{user:{}},deliveryFee:0,orderId:"",isLoading:!1}},inject:{emitter:["emitter"]},methods:{getOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/gary123-api/order/${this.orderId}`;this.axios.get(t).then((t=>{t.data.success&&(this.isLoading=!1,this.order=t.data.order,this.getCart())})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/gary123-api/cart";this.axios.get(t).then((t=>{t.data.success&&(this.cart=t.data.data)})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))},payOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/gary123-api/pay/${this.orderId}`;setTimeout((()=>{this.axios.post(t).then((t=>{if(t.data.success){let t;this.isLoading=!1,this.emitter.emit("update-cart",this.cart.carts.id),K().fire({icon:"success",title:"付款完成！",html:"將於 <b></b> 秒後關閉",timer:5e3,didOpen:()=>{K().showLoading();const e=K().getHtmlContainer().querySelector("b");t=setInterval((()=>{e.textContent=parseInt(K().getTimerLeft()/1e3)}),100)},willClose:()=>{clearInterval(t)}}).then((t=>{t.dismiss===K().DismissReason.timer&&this.$router.push("/productList")})),this.getOrder()}else this.isLoading=!1,K().fire({icon:"error",title:"付款失敗！",showConfirmButton:!1,timer:1500}),this.getOrder()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))}),2e3)}},created(){this.isLoading=!0,setTimeout((()=>{this.orderId=this.$route.params.orderId,this.getOrder(),this.isLoading=!1}),2e3)}},S=s(89);const V=(0,S.Z)(R,[["render",B]]);var W=V}}]);
//# sourceMappingURL=108.96f01f36.js.map