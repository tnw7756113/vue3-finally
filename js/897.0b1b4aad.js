"use strict";(self["webpackChunkproject_vue3_finally"]=self["webpackChunkproject_vue3_finally"]||[]).push([[897],{897:function(t,e,l){l.r(e),l.d(e,{default:function(){return ut}});var a=l(3396),d=l(7139),s=l(9242);const i={class:"table-responsive"},r={class:"table mt-4"},n=(0,a._)("thead",{class:"table-beige text-brown"},[(0,a._)("tr",{class:"text-nowrap"},[(0,a._)("th",{width:"120"},"購買時間"),(0,a._)("th",{width:"120"},"E-mail"),(0,a._)("th",{width:"240"},"購買款項"),(0,a._)("th",{width:"120"},"應付金額"),(0,a._)("th",{width:"100"},"是否付款"),(0,a._)("th",{width:"200"},"編輯")])],-1),o=["textContent"],u={class:"list-unstyled"},p={class:"text-right"},c={class:"form-check form-switch"},h=["id","onUpdate:modelValue","onChange"],_=["for"],m={key:0},g={key:1},w={class:"btn-group"},b=["onClick"],y=["onClick"];function O(t,e,l,O,f,k){const x=(0,a.up)("LoadingView"),v=(0,a.up)("OrderModal"),M=(0,a.up)("DelModal"),D=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(x,{active:f.isLoading},null,8,["active"]),(0,a._)("div",i,[(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.orders,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[f.orders.length?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,d.C_)(["align-middle text-nowrap",{"text-secondary":!e.is_paid}])},[(0,a._)("td",null,(0,d.zw)(t.$filters.date(e.create_at)),1),(0,a._)("td",null,[e.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,d.zw)(e.user.email)},null,8,o)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id},(0,d.zw)(t.product.title)+" 數量："+(0,d.zw)(t.qty)+" "+(0,d.zw)(t.product.unit),1)))),128))])]),(0,a._)("td",p,(0,d.zw)(e.total),1),(0,a._)("td",null,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>k.updatePaid(e)},null,40,h),[[s.e8,e.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${e.id}`},[e.is_paid?((0,a.wg)(),(0,a.iD)("span",m,"已付款")):((0,a.wg)(),(0,a.iD)("span",g,"未付款"))],8,_)])]),(0,a._)("td",null,[(0,a._)("div",w,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t=>k.openOrderModal(e)},"檢視",8,b),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>k.openDeleteModal(e)},"刪除",8,y)])])],2)):(0,a.kq)("",!0)],64)))),128))])])]),(0,a.Wm)(v,{ref:"orderModal",order:f.tempOrder,onUpdatePaid:k.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(M,{item:f.tempOrder,ref:"deleteModal",onDeleteProduct:k.delOrder},null,8,["item","onDeleteProduct"]),(0,a.Wm)(D,{pages:f.pagination,onEmitPage:k.getOrders},null,8,["pages","onEmitPage"])],64)}const f={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},k={class:"modal-dialog modal-xl",role:"document"},x={class:"modal-content border-0"},v=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),M={class:"modal-body"},D={class:"row"},z={class:"col-md-4"},$=(0,a._)("h3",null,"用戶資料",-1),L={class:"table"},P={key:0},C=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),q=(0,a._)("th",null,"Email",-1),H=(0,a._)("th",null,"電話",-1),Y=(0,a._)("th",null,"地址",-1),Z={class:"border border-white"},E=(0,a._)("th",null,"留言",-1),S={class:"col-md-8"},U=(0,a._)("h3",null,"訂單細節",-1),W={class:"table"},j=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),K=(0,a._)("th",null,"下單時間",-1),V=(0,a._)("th",null,"付款時間",-1),A={key:0},B={key:1},F=(0,a._)("th",null,"付款狀態",-1),G={key:0,class:"text-success"},I={key:1,class:"text-danger"},J=(0,a._)("th",null,"總金額",-1),N=(0,a._)("h3",null,"選購商品",-1),Q={class:"table"},R=(0,a._)("thead",{class:"table-dark"},[(0,a._)("tr",null,[(0,a._)("th",null,"商品名稱"),(0,a._)("th",null,"單價"),(0,a._)("th",null,"數量"),(0,a._)("th",{class:"text-end"},"小計")])],-1),T={class:"text-end"},X=(0,a._)("div",{class:"modal-footer"},[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"關閉")],-1);function tt(t,e,l,s,i,r){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",k,[(0,a._)("div",x,[v,(0,a._)("div",M,[(0,a._)("div",D,[(0,a._)("div",z,[$,(0,a._)("table",L,[i.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",P,[(0,a._)("tr",null,[C,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.name),1)]),(0,a._)("tr",null,[q,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.email),1)]),(0,a._)("tr",null,[H,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.tel),1)]),(0,a._)("tr",null,[Y,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.address),1)]),(0,a._)("tr",Z,[E,(0,a._)("td",null,(0,d.zw)(i.tempOrder.message),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",S,[U,(0,a._)("table",W,[(0,a._)("tbody",null,[(0,a._)("tr",null,[j,(0,a._)("td",null,(0,d.zw)(i.tempOrder.id),1)]),(0,a._)("tr",null,[K,(0,a._)("td",null,(0,d.zw)(t.$filters.date(i.tempOrder.create_at)),1)]),(0,a._)("tr",null,[V,(0,a._)("td",null,[i.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",A,(0,d.zw)(t.$filters.date(i.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",B,"時間不正確"))])]),(0,a._)("tr",null,[F,(0,a._)("td",null,[i.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",G,"已付款")):((0,a.wg)(),(0,a.iD)("span",I,"尚未付款"))])]),(0,a._)("tr",null,[J,(0,a._)("td",null,(0,d.zw)(t.$filters.currency(i.tempOrder.total)),1)])])]),N,(0,a._)("table",Q,[R,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.tempOrder.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,d.zw)(e.product.title),1),(0,a._)("td",null,(0,d.zw)(e.product.price),1),(0,a._)("td",null,(0,d.zw)(e.qty)+" / "+(0,d.zw)(e.product.unit),1),(0,a._)("td",T,(0,d.zw)(t.$filters.currency(e.final_total)),1)])))),128))])])])])]),X])])],512)}var et=l(1339),lt={name:"orderModal",props:{order:{type:Object,default(){return{}}}},watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},emits:["update-product"],mixins:[et.Z]},at=l(89);const dt=(0,at.Z)(lt,[["render",tt]]);var st=dt,it=l(1016),rt=l(4286),nt={data(){return{orders:[],pagination:{},tempOrder:{},isLoading:!1}},components:{OrderModal:st,DelModal:it.Z,Pagination:rt.Z},methods:{getOrders(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/gary123-api/admin/orders?page=${t}`;this.axios.get(e).then((t=>{t.data.success&&(this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1)})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))},openOrderModal(t){this.tempOrder={...t},this.$refs.orderModal.showModal()},openDeleteModal(t){this.tempOrder={...t},this.$refs.deleteModal.showModal()},updatePaid(t){this.isLoading=!0;const e={is_paid:t.is_paid},l=`https://vue3-course-api.hexschool.io/api/gary123-api/admin/order/${t.id}`;this.axios.put(l,{data:e}).then((t=>{this.isLoading=!1,this.$refs.orderModal.hideModal(),this.$httpMessageStatus(t,"更新付款狀態"),this.getOrders()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))},delOrder(){const t=`https://vue3-course-api.hexschool.io/api/gary123-api/admin/order/${this.tempOrder.id}`;this.isLoading=!0,this.axios.delete(t).then((t=>{this.isLoading=!1,this.$refs.deleteModal.hideModal(),this.$httpMessageStatus(t,"刪除訂單"),this.getOrders()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data.message})}))}},created(){this.getOrders()}};const ot=(0,at.Z)(nt,[["render",O]]);var ut=ot}}]);
//# sourceMappingURL=897.0b1b4aad.js.map